Temporary backup of this code. In need of house cleaning.
